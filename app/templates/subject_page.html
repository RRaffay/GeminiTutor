<!-- Subject Page Template: subject_page.html -->
{% extends "base.html" %} {% block content %}
<div class="container mt-5">
  <h1>{{ subject_name }}</h1>
  <div class="card p-3 mb-3">
    <h5 class="card-title">Current Goal:</h5>
    <h3 id="goalText" class="card-text">{{ goal }}</h3>
    <div class="input-group mb-3" id="goalInput" style="display: none">
      <input type="text" class="form-control" name="goal" value="{{ goal }}" />
      <button class="btn btn-outline-primary" onclick="confirmUpdateGoal()">
        Save Changes
      </button>
    </div>
    <button
      type="button"
      class="btn btn-outline-secondary"
      onclick="editGoal()"
    >
      Edit
    </button>
  </div>
  <div class="container mt-5">
    {% if first_visit %}
    <div class="card p-3">
      <h2 class="card-title">Welcome to the {{ subject_name }} page!</h2>
      <p class="card-text">
        To better tailor our recommendations to your needs, please answer the
        following questions:
      </p>
      <form id="questionsForm" class="card-body">
        {% for question in questions %}
        <div class="mb-3">
          <label for="answer{{ loop.index }}" class="form-label"
            >{{ question.question }}</label
          >
          <textarea
            class="form-control"
            id="answer{{ loop.index }}"
            name="answer{{ loop.index }}"
            rows="3"
            required
          ></textarea>
        </div>
        {% endfor %}
        <button type="submit" class="btn btn-primary" onclick="submitAnswers()">
          Submit Answers
        </button>
      </form>
    </div>
    {% else %}
    <div class="recommendation-card">
      {{ recommendation|safe }}
      <button type="button" class="btn btn-primary" onclick="fetchQuestions()">
        Fetch Questions
      </button>
    </div>
    {% endif %}
  </div>
</div>
{% endblock %}
